# Домашнее задание №3  
Новиков Иван

 

---

## 1. Развернуты таблицы для выполнения ДЗ. 

Напоминаю, у меня PostgreSQL и pgAdmin были развернуты в Docker под WSL2.
Данные были скорректированы / очищены.


Сначала я как "честный самаритянин" начала заново разворачивать все таблицы, но когда я начал импортировать данные, я 

https://disk.yandex.ru/i/8Le76BR_hm74oQ
https://disk.yandex.ru/i/L7hl3Bel4Cmo-A
https://disk.yandex.ru/i/nvvuuAbrROdzCA
https://disk.yandex.ru/i/Rn6mw1K03eOE1A

увидел, что *идут теже ошибки, что в и прошлый раз*. Далее я полез сразнивать поля таблиц (все 1к1 вроде) и данные в таблицых
(тоже совпали, при беглом анализе).
Соотв. далее я вернулся к таблицам от ДЗ №2, чтобы работать с ними =)

## 2. Задания по запросам ДЗ №3

**Запрос 1.**
*Вывести распределение (количество) клиентов по сферам деятельности, отсортировав результат по убыванию количества*

```sql




```
**Результат:**




Скриншоты: 


.



**Запрос 2.**
*Найти общую сумму дохода (list_price*quantity) по всем подтвержденным заказам за каждый месяц по сферам деятельности клиентов. Отсортировать по году, месяцу и сфере деятельности*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 3.**
*Вывести количество уникальных онлайн-заказов для всех брендов в рамках подтвержденных заказов клиентов из сферы IT. Включить бренды, у которых нет онлайн-заказов от IT-клиентов, с количеством 0*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 4.**
*Найти по всем клиентам: сумму всех заказов (общего дохода), максимум, минимум и количество заказов, а также среднюю сумму заказа по каждому клиенту. Отсортировать результат по убыванию суммы всех заказов и количества заказов. Выполнить двумя способами: используя только GROUP BY и используя только оконные функции. Сравнить результат*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 5.**
*Найти имена и фамилии клиентов с топ-3 минимальной и топ-3 максимальной суммой транзакций за весь период (учесть клиентов, у которых нет заказов)*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 6.**
*Вывести только вторые транзакции клиентов (если они есть). Решить с помощью оконных функций. Если у клиента меньше двух транзакций, он не должен попасть в результат*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 7.**
*Вывести имена, фамилии и профессии клиентов, а также длительность максимального интервала (в днях) между двумя последовательными заказами. Исключить клиентов, у которых только один или меньше заказов*

```sql




```
**Результат:**




Скриншоты: 


.




**Запрос 8.**
*Найти топ-5 клиентов (по общему доходу) в каждом сегменте благосостояния (wealth_segment). Вывести имя, фамилию, сегмент и общий доход. Если в сегменте менее 5 клиентов, вывести всех*

```sql




```
**Результат:**




Скриншоты: 


.






.
.

